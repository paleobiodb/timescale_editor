<!-- REQUIRES_LOGIN=1; -->
<!-- This web form implements an application for editing timescales the Paleobiology Database, -->
<!-- using the database's API.  The application -->
<!-- code resides in timescale_editor.js. -->
<!-- Author: Michael McClennen -->

<link rel="stylesheet" type="text/css" href="%%app_resources%%/timescale_editor.css">
<link rel="stylesheet" type="text/css" href="%%common_resources%%/pbdb_webapp.css">
<script src="%%common_resources%%/jquery-2.0.3.min.js" language="JavaScript" type="text/javascript"></script>
<script src="%%common_resources%%/underscore-1.8.3.min.js" language="JavaScript" type="text/javascript"></script>
<script src="%%common_resources%%/pbdb_webapp.js" language="JavaScript" type="text/javascript"></script>
<script src="%%common_resources%%/pbdb_dynamic_content.js" language="JavaScript" type="text/javascript"></script>
<script src="%%app_resources%%/timescale_editor.js" language="JavaScript" type="text/javascript"></script>

<script language="JavaScript" type="text/javascript">
<!--
// This file is processed by the code in WebApp.pm when before it is sent to the client
// web browser, and the %%...%% literals are replaced by values known to the Classic environment.
// %%data_url%% is read from the Classic environment configuration file, and %%is_contributor%%
// is set to 1 if this page is being displayed for a logged-in user.  A standard header is also prepended, which
// defines some other javascript global variables and also provides the header bar for the
// resulting web page.

var tsapp = new TimescaleEditorApp('%%test_data_url%%', '%%app_resources%%', '%%is_contributor%%');
document.addEventListener("DOMContentLoaded", tsapp.initApp, false);

//  End -->
</script>

<!-- Section I of the application pane, with heading and explanatory note. -->

<div name="intro" style="margin-left: 1em; margin-right: 1em;">

  <p align="center" class="pageTitle">Edit Timescales</p>
  
  <p class="small"> This web app allows you to edit timescales in the Paleobiology Database.
  Its functionality is based on the PBDB
  <a class="dlBoldURL" target="_blank" href="%%data_url%%">data service</a>.</p>

  <p class="small">To learn more about the various parts of this form, use the
  <img width="16" height="16" src="/JavaScripts/img/hidden_help.png"> buttons.</p>
  
</div>

<!-- This box is visible when the application is first opened, and disappears once the -->
<!-- initialization steps are complete.  If it remains visible, something has gone wrong with the -->
<!-- initialization. -->

<div id="db_initmsg" class="dlMessageBox" style="width: 300px; height: 100px;">
	<span id="initmsg" class="large">Initializing form, please wait...</span>
</div>

<div name="editor" id="editor">
  <table border="1">
    <tr>
      <td id="edit_selector" width="70%">
      	<div align="center">
  			<div align="center" class="col-sm-6" id="edit_attrs" onclick="tsapp.selectPane('ts_attrs_pane', 'edit_attrs')">Timescale attributes</div>
			<div align="center" class="col-sm-6" id="edit_bounds" onclick="tsapp.selectPane('bounds_pane', 'edit_bounds')">Bounds</div>
		</div>
      </td>
    </tr>
    <tr>
      <td id="ts_list" style="vertical-align: top; height:500px;">
		<div style="max-height: 500px; overflow: auto;">
			<table id="timescales_box" border="1">
			</table>
		</div>
      </td>
      <td id="ts_attrs_pane" style="vertical-align: top; display: none">
	<form id="ts_attrs_form" name="ts_attrs_form">
		<div class="btn-holder">
		  <input type="button" class="btn" name="save" value="Save changes" onclick="tsapp.saveTimescaleAttrs()">
		  <input type="reset" class="btn btn-secondary" name="reset" value="Reset">
	  	</div>
	  <table id="ts_attrs_box" border="0" cellpadding="3">
	    <tr><td>Timescale name:</td>
	        <td><input id="ts_name" type="text" size="40" onchange="tsapp.checkTimescaleAttrs()"/>
		</td></tr>
	    <tr><td>Age range:</td>
	        <td><input id="ts_min_age" type="text" size="10" disabled/> through
		  <input id="ts_max_age" type="text" size="10" disabled/>
		</td></tr>
	    <tr><td>Timescale type:</td>
	        <td><select id="ts_type" onchange="tsapp.checkTimescaleAttrs()"></select>
		  <span style="margin-left: 20px;">Timescale id:<span>
	            <input id="ts_id" type="text" size="8" disabled/>		
	        </td></tr>
	    <tr><td>Timescale extent:</td>
	        <td><input id="ts_extent" type="text" size="40" onchange="tsapp.checkTimescaleAttrs()"/>
		</td></tr>
	    <tr><td>Timescale taxon:</td>
	        <td><input id="ts_taxon" type="text" size="40" onchange="tsapp.checkTimescaleAttrs()"/>
	        </td></tr>
	    <tr><td>Timescale comments:</td>
	        <td><textarea id="ts_comments" rows=2 columns=40 onchange="tsapp.checkTimescaleAttrs()">
		    </textarea>
	        </td></tr>
	</table>
	</form></td>
      <td id="bounds_pane" style="vertical-align: top; height: 500px; display: none">
	<form id="bounds_form" name="bounds_form">
		<div class="btn-holder">
		  <input type="button" class="btn" name="save" value="Save changes" onclick="tsapp.saveBoundsForm()">
		  <input type="reset" class="btn" name="reset" value="Reset">
		  <input type="button" class="btn" name="model" value="Compare to ICS stages" onclick="tsapp.modelBoundsForm(event)" style="float:right;">
		</div>
		<table id="bounds_box_header"><tbody><tr>
			<td>Interval bounds</td>
			<td style="text-align: right;">Based on</td>
		</tr></tbody></table>
	  <div style="max-height: 500px; overflow: auto">
	    <table id="bounds_box" border="1" style="margin-top: 20px;">
	    </table></div>
        </form>
      </td></tr>
  </table>
  
</div>

<!-- The following boxes are modal dialogs, and only appear when -->
<!-- timescale and bound references are being selected. -->

<div id="timescale_selector" class="tsed_modal">

  <div class="tsed_modal_content" style="height: 500px">
    <span class="close" onclick="tsapp.closeModal('timescale_selector')">&times;</span>
    <h3>Select a timescale:</h3>
    <table id="timescale_selector_timescales" style="display: block; height: 400px; overflow: scroll">
    </table>
  </div>

</div>
    

<div id="bound_selector" class="tsed_modal">

  <div class="tsed_modal_content" style="height: 500px">
    <span class="close" onclick="tsapp.closeModal('bound_selector')">&times;</span>
    <h3>Select a boundary from one of the following timescales:</h3>
    <table width="80%" style="height: 450px;" cellpadding="5">
      <tr style="vertical-align: top">
	<td width="40%">
	  <table id="bound_selector_timescales" style="display: block; height: 400px; overflow: scroll">
	  </table></td>
	 <td><table id="bound_selector_bounds" style="display: block; height: 400px; overflow: scroll">
	</table></td></tr>
    </table>
  </div>

</div>






